{
  "sha": "08c0b297e5d80f32090155b4840ef22e73111dba",
  "node_id": "C_kwDOCQOkhNoAKDA4YzBiMjk3ZTVkODBmMzIwOTAxNTViNDg0MGVmMjJlNzMxMTFkYmE",
  "commit": {
    "author": {
      "name": "qwqcode",
      "email": "qwqcode@gmail.com",
      "date": "2023-05-10T05:42:04Z"
    },
    "committer": {
      "name": "GitHub",
      "email": "noreply@github.com",
      "date": "2023-05-10T05:42:04Z"
    },
    "message": "feat(gravatar): add `gravatar.params` config option (#508)\n\n* feat(gravatar): add `gravatar.params` config option\r\n\r\nBREAKING CHANGE: The `gravatar.default` config option has been removed. Please use `gravatar.params` instead. The default value for `gravatar.params` is now `\"d=mp&s=240\"`.\r\n\r\nSigned-off-by: qwqcode <qwqcode@gmail.com>\r\n\r\n* add docs and fix sidebar\r\n\r\nSigned-off-by: qwqcode <qwqcode@gmail.com>\r\n\r\n---------\r\n\r\nSigned-off-by: qwqcode <qwqcode@gmail.com>",
    "tree": {
      "sha": "be8cd97639b622d749ed78a5dc753b881cc953c6",
      "url": "https://api.github.com/repos/ArtalkJS/Artalk/git/trees/be8cd97639b622d749ed78a5dc753b881cc953c6"
    },
    "url": "https://api.github.com/repos/ArtalkJS/Artalk/git/commits/08c0b297e5d80f32090155b4840ef22e73111dba",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJkWy6sCRBK7hj4Ov3rIwAA9KoIAFVwyBBWdeNc7V7ZIRqhA3uM\nkukeVZvNr3AB4zI4nDwl7IkNfa6ODGKu2O481NLeN3/8+Lsbu8OaSW9PrM7G/Y4+\nRIJZ/owb7BLeD3/m4EPEoQIucQWTa8zfjKe+iiDVeS9iTjsJchMvULSuwUNZxKbj\nmMBO4k5xjeCzoFy4pNxLGo+43msAZmrfPLhxpmTdvw8IE6DfHpBpvRLrjWA+XiOr\nm8K9Twp2W4CZRCzgopHx5hMJ/t9tNsh4w1QiOkkxIrE5GyD79LfAlv1i1sjBNYHF\ndO0PV++39dh3EB72/v8RU+G4lquHF2Xkmp+9xvOObnY7Fv26nzjTZNo2tXum+Pg=\n=tgWI\n-----END PGP SIGNATURE-----\n",
      "payload": "tree be8cd97639b622d749ed78a5dc753b881cc953c6\nparent 01ed04c791afb5ebac3b3b4e3f64fb68219162cf\nauthor qwqcode <qwqcode@gmail.com> 1683697324 +0800\ncommitter GitHub <noreply@github.com> 1683697324 +0800\n\nfeat(gravatar): add `gravatar.params` config option (#508)\n\n* feat(gravatar): add `gravatar.params` config option\r\n\r\nBREAKING CHANGE: The `gravatar.default` config option has been removed. Please use `gravatar.params` instead. The default value for `gravatar.params` is now `\"d=mp&s=240\"`.\r\n\r\nSigned-off-by: qwqcode <qwqcode@gmail.com>\r\n\r\n* add docs and fix sidebar\r\n\r\nSigned-off-by: qwqcode <qwqcode@gmail.com>\r\n\r\n---------\r\n\r\nSigned-off-by: qwqcode <qwqcode@gmail.com>"
    }
  },
  "url": "https://api.github.com/repos/ArtalkJS/Artalk/commits/08c0b297e5d80f32090155b4840ef22e73111dba",
  "html_url": "https://github.com/ArtalkJS/Artalk/commit/08c0b297e5d80f32090155b4840ef22e73111dba",
  "comments_url": "https://api.github.com/repos/ArtalkJS/Artalk/commits/08c0b297e5d80f32090155b4840ef22e73111dba/comments",
  "author": {
    "login": "qwqcode",
    "id": 22412567,
    "node_id": "MDQ6VXNlcjIyNDEyNTY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/22412567?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qwqcode",
    "html_url": "https://github.com/qwqcode",
    "followers_url": "https://api.github.com/users/qwqcode/followers",
    "following_url": "https://api.github.com/users/qwqcode/following{/other_user}",
    "gists_url": "https://api.github.com/users/qwqcode/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qwqcode/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qwqcode/subscriptions",
    "organizations_url": "https://api.github.com/users/qwqcode/orgs",
    "repos_url": "https://api.github.com/users/qwqcode/repos",
    "events_url": "https://api.github.com/users/qwqcode/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qwqcode/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "web-flow",
    "id": 19864447,
    "node_id": "MDQ6VXNlcjE5ODY0NDQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/19864447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/web-flow",
    "html_url": "https://github.com/web-flow",
    "followers_url": "https://api.github.com/users/web-flow/followers",
    "following_url": "https://api.github.com/users/web-flow/following{/other_user}",
    "gists_url": "https://api.github.com/users/web-flow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/web-flow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/web-flow/subscriptions",
    "organizations_url": "https://api.github.com/users/web-flow/orgs",
    "repos_url": "https://api.github.com/users/web-flow/repos",
    "events_url": "https://api.github.com/users/web-flow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/web-flow/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "01ed04c791afb5ebac3b3b4e3f64fb68219162cf",
      "url": "https://api.github.com/repos/ArtalkJS/Artalk/commits/01ed04c791afb5ebac3b3b4e3f64fb68219162cf",
      "html_url": "https://github.com/ArtalkJS/Artalk/commit/01ed04c791afb5ebac3b3b4e3f64fb68219162cf"
    }
  ],
  "stats": {
    "total": 51,
    "additions": 34,
    "deletions": 17
  },
  "files": [
    {
      "sha": "f82cf09edac1a5142b453b4a23e079caf29ad116",
      "filename": "conf/artalk.example.simple.yml",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/conf%2Fartalk.example.simple.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/conf%2Fartalk.example.simple.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/conf%2Fartalk.example.simple.yml?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -152,7 +152,7 @@ frontend:\n   nestSort: DATE_ASC\n   gravatar:\n     mirror: \"https://www.gravatar.com/\"\n-    default: \"mp\"\n+    params: \"d=mp&s=240\"\n   pagination:\n     pageSize: 20\n     readMore: true"
    },
    {
      "sha": "e1c9c3035f3e729dc5246356e897ab2a6942ece6",
      "filename": "conf/artalk.example.yml",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/conf%2Fartalk.example.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/conf%2Fartalk.example.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/conf%2Fartalk.example.yml?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -297,8 +297,10 @@ frontend:\n   nestSort: DATE_ASC\n   # Gravatar\n   gravatar:\n+    # API URL\n     mirror: \"https://www.gravatar.com/\"\n-    default: \"mp\"\n+    # API parameters\n+    params: \"d=mp&s=240\"\n   # Comment pagination\n   pagination:\n     # Number of comments per page"
    },
    {
      "sha": "8a46a5c103c681a81362329a5d78e3b090d49aaa",
      "filename": "conf/artalk.example.zh-CN.yml",
      "status": "modified",
      "additions": 4,
      "deletions": 4,
      "changes": 8,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/conf%2Fartalk.example.zh-CN.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/conf%2Fartalk.example.zh-CN.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/conf%2Fartalk.example.zh-CN.yml?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -302,12 +302,12 @@ frontend:\n   nestMax: 2\n   # 嵌套评论排序规则 [\"DATE_ASC\", \"DATE_DESC\", \"VOTE_UP_DESC\"]\n   nestSort: DATE_ASC\n-  # 头像\n+  # 头像 Gravatar\n   gravatar:\n-    # Gravatar 镜像地址\n+    # API 地址\n     mirror: \"https://cravatar.cn/avatar/\"\n-    # 默认头像\n-    default: \"mp\"\n+    # API 参数\n+    params: \"d=mp&s=240\"\n   # 评论分页\n   pagination:\n     # 每页评论数"
    },
    {
      "sha": "972f66b43755d46cda6ce5b81d37ce345bfa0bd6",
      "filename": "docs/guide/frontend/config.md",
      "status": "modified",
      "additions": 15,
      "deletions": 3,
      "changes": 18,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/docs%2Fguide%2Ffrontend%2Fconfig.md",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/docs%2Fguide%2Ffrontend%2Fconfig.md",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/docs%2Fguide%2Ffrontend%2Fconfig.md?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -350,12 +350,24 @@ gravatar: {\n >\n > loli：https://gravatar.loli.net/avatar/\n \n-### gravatar.default\n+### gravatar.params\n \n-**默认头像**（URL or [Gravatar Type](http://cn.gravatar.org/site/implement/images/#default-image)）\n+**Gravatar API 参数**\n \n - 类型：`String`\n-- 默认值：`\"mp\"`\n+- 默认值：`\"d=mp&s=240\"`\n+\n+例如，你可以通过该配置项设置默认头像 (`d=mp`) 和头像尺寸 (`s=240`)。\n+\n+参考：[Gravatar API 文档](http://cn.gravatar.org/site/implement/images/)\n+\n+该配置项格式为 HTTP Query。\n+\n+::: warning 更新注意\n+\n+v2.5.5 已废弃 `gravatar.default` 配置项，请使用 `gravatar.params` 替代。\n+\n+:::\n \n ### avatarURLBuilder\n "
    },
    {
      "sha": "bc20ac19a0010d3b2165f66e955fea3344da5198",
      "filename": "ui/packages/artalk-sidebar/src/components/Header.vue",
      "status": "modified",
      "additions": 5,
      "deletions": 3,
      "changes": 8,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk-sidebar%2Fsrc%2Fcomponents%2FHeader.vue",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk-sidebar%2Fsrc%2Fcomponents%2FHeader.vue",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/ui%2Fpackages%2Fartalk-sidebar%2Fsrc%2Fcomponents%2FHeader.vue?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -11,9 +11,11 @@ const user = useUserStore()\n const { t } = useI18n()\n const { site: curtSite, isAdmin, email } = storeToRefs(user)\n \n-const userAvatarImgURL = computed(() =>\n-  `${(artalk?.ctx.conf.gravatar.mirror || '').replace(/\\/$/, '')}/${MD5(email.value)}`\n-  + `?d=${encodeURIComponent(artalk?.ctx.conf.gravatar.default || 'mp')}&s=80`)\n+const userAvatarImgURL = computed(() => {\n+  const conf = artalk?.ctx.conf?.gravatar\n+  if (!conf) return ``\n+  return `${conf.mirror.replace(/\\/$/, '')}/${MD5(email.value)}?${conf.params.replace(/^\\?/, '')}`\n+})\n </script>\n \n <template>"
    },
    {
      "sha": "a49f0e89db85b0090dca5d8c97cc75e969764788",
      "filename": "ui/packages/artalk/src/defaults.ts",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk%2Fsrc%2Fdefaults.ts",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk%2Fsrc%2Fdefaults.ts",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/ui%2Fpackages%2Fartalk%2Fsrc%2Fdefaults.ts?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -28,8 +28,8 @@ const defaults: ArtalkConfig = {\n   pvEl: '#ArtalkPV',\n \n   gravatar: {\n-    default: 'mp',\n     mirror: 'https://cravatar.cn/avatar/',\n+    params: 'd=mp&s=240',\n   },\n \n   pagination: {"
    },
    {
      "sha": "e1b87afc3c674edca771dc54765d36da358ac7d8",
      "filename": "ui/packages/artalk/src/lib/utils.ts",
      "status": "modified",
      "additions": 2,
      "deletions": 1,
      "changes": 3,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk%2Fsrc%2Flib%2Futils.ts",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk%2Fsrc%2Flib%2Futils.ts",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/ui%2Fpackages%2Fartalk%2Fsrc%2Flib%2Futils.ts?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -116,7 +116,8 @@ export function onImagesLoaded($container: HTMLElement, event: Function) {\n }\n \n export function getGravatarURL(ctx: Context, emailMD5: string) {\n-  return `${(ctx.conf.gravatar.mirror).replace(/\\/$/, '')}/${emailMD5}?d=${encodeURIComponent(ctx.conf.gravatar.default)}&s=80`\n+  const { mirror, params } = ctx.conf.gravatar\n+  return `${mirror.replace(/\\/$/, '')}/${emailMD5}?${params.replace(/^\\?/, '')}`\n }\n \n export function sleep(ms: number) {"
    },
    {
      "sha": "906474cf662bb189e5997f2ede1da39e6f151b9a",
      "filename": "ui/packages/artalk/types/artalk-config.d.ts",
      "status": "modified",
      "additions": 3,
      "deletions": 3,
      "changes": 6,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk%2Ftypes%2Fartalk-config.d.ts",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/08c0b297e5d80f32090155b4840ef22e73111dba/ui%2Fpackages%2Fartalk%2Ftypes%2Fartalk-config.d.ts",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/ui%2Fpackages%2Fartalk%2Ftypes%2Fartalk-config.d.ts?ref=08c0b297e5d80f32090155b4840ef22e73111dba",
      "patch": "@@ -34,10 +34,10 @@ export default interface ArtalkConfig {\n \n   /** Gravatar 头像 */\n   gravatar: {\n-    /** 镜像 */\n+    /** API 地址 */\n     mirror: string\n-    /** 默认头像（URL or Gravatar Type） */\n-    default: string\n+    /** API 参数 */\n+    params: string\n   }\n \n   /** 头像链接生成器 */"
    }
  ]
}
