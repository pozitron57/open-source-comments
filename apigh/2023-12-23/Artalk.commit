{
  "sha": "60e0e7e61a412b678d9666f059a26d86e19788f9",
  "node_id": "C_kwDOCQOkhNoAKDYwZTBlN2U2MWE0MTJiNjc4ZDk2NjZmMDU5YTI2ZDg2ZTE5Nzg4Zjk",
  "commit": {
    "author": {
      "name": "qwqcode",
      "email": "qwqcode@gmail.com",
      "date": "2023-12-22T17:14:40Z"
    },
    "committer": {
      "name": "qwqcode",
      "email": "qwqcode@gmail.com",
      "date": "2023-12-22T17:32:19Z"
    },
    "message": "chore(ci): fixed tag version for git checkout branch",
    "tree": {
      "sha": "b8ba9d545ea01422336d98d631f8c5581879efc8",
      "url": "https://api.github.com/repos/ArtalkJS/Artalk/git/trees/b8ba9d545ea01422336d98d631f8c5581879efc8"
    },
    "url": "https://api.github.com/repos/ArtalkJS/Artalk/git/commits/60e0e7e61a412b678d9666f059a26d86e19788f9",
    "comment_count": 0,
    "verification": {
      "verified": true,
      "reason": "valid",
      "signature": "-----BEGIN PGP SIGNATURE-----\n\niHUEABYIAB0WIQS0Ev3sdPZbHkWwzmLUbg8O6nwTagUCZYXIIwAKCRDUbg8O6nwT\nani3AQCwuUNnRPd3ziCwgkcVIcIdAu91hcsqkyDTfITJZaGRgQD/VJ+fMKrq0BHQ\nZfDxzkbE/VEF9ygEmKEb0stM3He9/g8=\n=I4vV\n-----END PGP SIGNATURE-----",
      "payload": "tree b8ba9d545ea01422336d98d631f8c5581879efc8\nparent e4a42d3a90c59c98dc585f6c63766a540d83054f\nauthor qwqcode <qwqcode@gmail.com> 1703265280 +0800\ncommitter qwqcode <qwqcode@gmail.com> 1703266339 +0800\n\nchore(ci): fixed tag version for git checkout branch\n"
    }
  },
  "url": "https://api.github.com/repos/ArtalkJS/Artalk/commits/60e0e7e61a412b678d9666f059a26d86e19788f9",
  "html_url": "https://github.com/ArtalkJS/Artalk/commit/60e0e7e61a412b678d9666f059a26d86e19788f9",
  "comments_url": "https://api.github.com/repos/ArtalkJS/Artalk/commits/60e0e7e61a412b678d9666f059a26d86e19788f9/comments",
  "author": {
    "login": "qwqcode",
    "id": 22412567,
    "node_id": "MDQ6VXNlcjIyNDEyNTY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/22412567?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qwqcode",
    "html_url": "https://github.com/qwqcode",
    "followers_url": "https://api.github.com/users/qwqcode/followers",
    "following_url": "https://api.github.com/users/qwqcode/following{/other_user}",
    "gists_url": "https://api.github.com/users/qwqcode/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qwqcode/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qwqcode/subscriptions",
    "organizations_url": "https://api.github.com/users/qwqcode/orgs",
    "repos_url": "https://api.github.com/users/qwqcode/repos",
    "events_url": "https://api.github.com/users/qwqcode/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qwqcode/received_events",
    "type": "User",
    "site_admin": false
  },
  "committer": {
    "login": "qwqcode",
    "id": 22412567,
    "node_id": "MDQ6VXNlcjIyNDEyNTY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/22412567?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qwqcode",
    "html_url": "https://github.com/qwqcode",
    "followers_url": "https://api.github.com/users/qwqcode/followers",
    "following_url": "https://api.github.com/users/qwqcode/following{/other_user}",
    "gists_url": "https://api.github.com/users/qwqcode/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qwqcode/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qwqcode/subscriptions",
    "organizations_url": "https://api.github.com/users/qwqcode/orgs",
    "repos_url": "https://api.github.com/users/qwqcode/repos",
    "events_url": "https://api.github.com/users/qwqcode/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qwqcode/received_events",
    "type": "User",
    "site_admin": false
  },
  "parents": [
    {
      "sha": "e4a42d3a90c59c98dc585f6c63766a540d83054f",
      "url": "https://api.github.com/repos/ArtalkJS/Artalk/commits/e4a42d3a90c59c98dc585f6c63766a540d83054f",
      "html_url": "https://github.com/ArtalkJS/Artalk/commit/e4a42d3a90c59c98dc585f6c63766a540d83054f"
    }
  ],
  "stats": {
    "total": 31,
    "additions": 21,
    "deletions": 10
  },
  "files": [
    {
      "sha": "fc29a24164dcad82584da7e7afdddcfc08a94250",
      "filename": ".github/workflows/build-app.yml",
      "status": "modified",
      "additions": 3,
      "deletions": 1,
      "changes": 4,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-app.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-app.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Fbuild-app.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -24,6 +24,9 @@ jobs:\n       - name: Checkout Code\n         uses: actions/checkout@v4\n         with:\n+          ref: ${{ inputs.version }}\n+          # `go-releaser` will read the semver version from git tag name\n+          # `git-chglog` will diff the tag and generate changelog\n           fetch-depth: 0\n \n       # disable cache because the err `no space left on device`\n@@ -78,7 +81,6 @@ jobs:\n             -v $(pwd):/go/src/${PKG_NAME} \\\n             -w /go/src/${PKG_NAME} \\\n             -e CGO_ENABLED=1 \\\n-            -e VERSION=${{ inputs.version }} \\\n             --env-file local/.release-env \\\n             ghcr.io/goreleaser/goreleaser-cross:v${GO_VERSION} \\\n             release --release-notes local/release-notes.md ${{ inputs.dry_run && '--skip=publish' || '' }}"
    },
    {
      "sha": "ac316ea35d92161eb41413160dbeeaef194879a7",
      "filename": ".github/workflows/build-docker.yml",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-docker.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-docker.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Fbuild-docker.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -23,6 +23,8 @@ jobs:\n     steps:\n       - name: Checkout Code\n         uses: actions/checkout@v4\n+        with:\n+          ref: ${{ inputs.version }}\n \n       # https://github.com/docker/metadata-action\n       - name: Gen docker meta"
    },
    {
      "sha": "c07040acd27cfd45837ff195b8776bf871b164c5",
      "filename": ".github/workflows/build-done.yml",
      "status": "modified",
      "additions": 5,
      "deletions": 4,
      "changes": 9,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-done.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-done.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Fbuild-done.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -14,17 +14,18 @@ on:\n         type: number\n \n jobs:\n-  tagging:\n+  done:\n     runs-on: ubuntu-latest\n     steps:\n       - name: Checkout Code\n         uses: actions/checkout@v4\n+        with:\n+          ref: ${{ inputs.version }}\n \n       - name: Comment done info\n         uses: ./.github/actions/comment\n         if: ${{ inputs.issue_number != 0 }}\n         with:\n           issue_number: ${{ inputs.issue_number }}\n-          content: |\n-            ðŸŽ‰ Finished build and publish version ${{ inputs.version }}.\n-\n+          content: |-\n+            ðŸŽ‰ Finished build and publish ${{ inputs.version }} ([NPM Package](https://www.npmjs.com/package/artalk?activeTab=versions) / [Docker Image](https://hub.docker.com/r/artalk/artalk-go/tags) / [Github Release](https://github.com/ArtalkJS/Artalk/releases/tag/${{ inputs.version }}))."
    },
    {
      "sha": "a6a6204fa3fbfe547608f6047524a6c010ab52b0",
      "filename": ".github/workflows/build-tagging.yml",
      "status": "modified",
      "additions": 2,
      "deletions": 2,
      "changes": 4,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-tagging.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-tagging.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Fbuild-tagging.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -54,7 +54,7 @@ jobs:\n         if: ${{ inputs.issue_number != 0 }}\n         with:\n           issue_number: ${{ inputs.issue_number }}\n-          content: |\n-            ðŸ”– Tagged version [${{ env.VERSION }}](https://github.com/ArtalkJS/Artalk/tree/${{ env.VERSION }}), also see [CHANGELOG.md](https://github.com/ArtalkJS/Artalk/blob/master/CHANGELOG.md).\n+          content: |-\n+            ðŸ”– Tagged version [${{ env.VERSION }}](https://github.com/ArtalkJS/Artalk/tree/${{ env.VERSION }}) and updated the [CHANGELOG.md](https://github.com/ArtalkJS/Artalk/blob/master/CHANGELOG.md).\n     outputs:\n       version: ${{ env.VERSION }}"
    },
    {
      "sha": "a0495aea408b214ecfc2911f5f839b253f8d3f81",
      "filename": ".github/workflows/build-ui.yml",
      "status": "modified",
      "additions": 2,
      "deletions": 0,
      "changes": 2,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-ui.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild-ui.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Fbuild-ui.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -17,6 +17,8 @@ jobs:\n     steps:\n       - name: Checkout Code\n         uses: actions/checkout@v4\n+        with:\n+          ref: ${{ inputs.version }}\n \n       - name: Use pnpm\n         uses: pnpm/action-setup@v2"
    },
    {
      "sha": "b878c05452a5b190484172674d80b1f31fd29334",
      "filename": ".github/workflows/build.yml",
      "status": "modified",
      "additions": 1,
      "deletions": 1,
      "changes": 2,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Fbuild.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Fbuild.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -11,7 +11,7 @@ on:\n       dry_run:\n         description: 'Dry run'\n         type: boolean\n-        default: false\n+        default: true\n       build_items:\n         description: 'Build items'\n         type: string"
    },
    {
      "sha": "1a5d5872ec2036cdc5d40420dec141dbf97d5c7b",
      "filename": ".github/workflows/release.yml",
      "status": "modified",
      "additions": 6,
      "deletions": 2,
      "changes": 8,
      "blob_url": "https://github.com/ArtalkJS/Artalk/blob/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Frelease.yml",
      "raw_url": "https://github.com/ArtalkJS/Artalk/raw/60e0e7e61a412b678d9666f059a26d86e19788f9/.github%2Fworkflows%2Frelease.yml",
      "contents_url": "https://api.github.com/repos/ArtalkJS/Artalk/contents/.github%2Fworkflows%2Frelease.yml?ref=60e0e7e61a412b678d9666f059a26d86e19788f9",
      "patch": "@@ -24,6 +24,7 @@ jobs:\n       - name: Checkout Code\n         uses: actions/checkout@v4\n         with:\n+          ref: master\n           fetch-depth: 0\n \n       - name: Setup Node\n@@ -32,6 +33,9 @@ jobs:\n           node-version: 18.x\n           registry-url: https://registry.npmjs.org/\n \n+      - name: Setup semver\n+        run: npm install -g semver\n+\n       - name: Handle Version Number\n         run: |\n           PREV_VERSION=\"$(git describe --tags --abbrev=0)\"\n@@ -66,18 +70,18 @@ jobs:\n \n       - name: Create Pull Request\n         uses: peter-evans/create-pull-request@v5\n+        if: ${{ !inputs.dry_run }}\n         with:\n           branch: \"release/${{ env.VERSION }}\"\n           commit-message: \"chore: release ${{ env.VERSION }}\"\n           title: \"chore: release ${{ env.VERSION }}\"\n           labels: release\n           body: |\n-            # Release ${{ env.VERSION }} ðŸ“¦ðŸš€\n+            ## Release ${{ env.VERSION }} ðŸ“¦ðŸš€\n \n             This PR is auto-generated, please check the changelog and confirm the release. ðŸ˜€\n \n             The build workflow will be triggered after the PR is merged.\n           committer: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>\n           author: github-actions[bot] <41898282+github-actions[bot]@users.noreply.github.com>\n           assignees: ${{ github.actor }}\n-          draft: ${{ inputs.dry_run }}"
    }
  ]
}
